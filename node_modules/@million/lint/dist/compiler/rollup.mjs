var B=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,r)=>(typeof require<"u"?require:t)[r]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')});import{createUnplugin as Ot}from"unplugin";import{createFilter as Xt}from"@rollup/pluginutils";import{transformAsync as $t}from"@babel/core";import*as v from"@babel/types";import{gray as ct,red as pt,yellow as mt}from"kleur/colors";var d=(e,t)=>(...r)=>{if(ce()!=="debug")return e(...r);let o=performance.now(),a=e(...r),i=performance.now(),l=Number((i-o).toFixed(4));return l<.025||(l>.1?l=pt(l):l>.05&&(l=mt(l)),console.log(`   - ${l}ms ${ct(`| ${t}`)}`)),a};var pe=d(e=>{let t=e.node.directives;if(!t)return!1;let r=!1;for(let n=0,o=t.length;n<o;n++)if(t[n].value.value==="use client"){r=!0;break}return r},"hasUseClientDirective:check.ts"),Q=new Map,Z=d(e=>{var r;if(!e)return!1;if(Q.has(e))return Q.get(e);let t=!1;for(let n=0,o=((r=e.node.leadingComments)==null?void 0:r.length)||0;n<o;n++)if(e.node.leadingComments[n].value.includes("million ignore")){t=!0;break}return Q.set(e,t),t?!0:Z(e.parentPath)},"shouldIgnore:check.ts");import{addNamed as ue}from"@babel/helper-module-imports";import*as A from"@babel/types";import*as s from"@babel/types";var Y=d(e=>s.isTSParameterProperty(e)||s.isTSDeclareFunction(e)||s.isTSDeclareMethod(e)||s.isTSQualifiedName(e)||s.isTSCallSignatureDeclaration(e)||s.isTSConstructSignatureDeclaration(e)||s.isTSPropertySignature(e)||s.isTSMethodSignature(e)||s.isTSIndexSignature(e)||s.isTSAnyKeyword(e)||s.isTSBooleanKeyword(e)||s.isTSBigIntKeyword(e)||s.isTSIntrinsicKeyword(e)||s.isTSNeverKeyword(e)||s.isTSNullKeyword(e)||s.isTSNumberKeyword(e)||s.isTSObjectKeyword(e)||s.isTSStringKeyword(e)||s.isTSSymbolKeyword(e)||s.isTSUndefinedKeyword(e)||s.isTSUnknownKeyword(e)||s.isTSVoidKeyword(e)||s.isTSThisType(e)||s.isTSFunctionType(e)||s.isTSConstructorType(e)||s.isTSTypeReference(e)||s.isTSTypePredicate(e)||s.isTSTypeQuery(e)||s.isTSTypeLiteral(e)||s.isTSArrayType(e)||s.isTSTupleType(e)||s.isTSOptionalType(e)||s.isTSRestType(e)||s.isTSNamedTupleMember(e)||s.isTSUnionType(e)||s.isTSIntersectionType(e)||s.isTSConditionalType(e)||s.isTSInferType(e)||s.isTSParenthesizedType(e)||s.isTSTypeOperator(e)||s.isTSIndexedAccessType(e)||s.isTSMappedType(e)||s.isTSLiteralType(e)||s.isTSExpressionWithTypeArguments(e)||s.isTSInterfaceDeclaration(e)||s.isTSInterfaceBody(e)||s.isTSTypeAliasDeclaration(e)||s.isTSInstantiationExpression(e)||s.isTSAsExpression(e)||s.isTSSatisfiesExpression(e)||s.isTSTypeAssertion(e)||s.isTSEnumDeclaration(e)||s.isTSEnumMember(e)||s.isTSModuleDeclaration(e)||s.isTSModuleBlock(e)||s.isTSImportType(e)||s.isTSImportEqualsDeclaration(e)||s.isTSExternalModuleReference(e)||s.isTSNonNullExpression(e)||s.isTSExportAssignment(e)||s.isTSNamespaceExportDeclaration(e)||s.isTSTypeAnnotation(e)||s.isTSTypeParameterInstantiation(e)||s.isTSTypeParameterDeclaration(e)||s.isTSTypeParameter(e),"isTypeScript:mod.ts");import*as R from"@babel/types";var ut=/<(?<temp1>"[^"]*"|'[^']*'|[^'">])*>/,J=d(e=>{if(ut.test(e.getSource()))return!0;let t=!1;return e.traverse({JSXElement(r){t=!0,r.stop()},JSXFragment(r){t=!0,r.stop()}}),t},"hasJSX:jsx.ts"),k=d(e=>!e.length||!/[a-zA-Z]/.test(e[0])?!1:e[0]===e[0].toUpperCase(),"isCapitalized:jsx.ts"),me=d(e=>R.isJSXIdentifier(e)?R.identifier(e.name):R.isJSXMemberExpression(e)?R.memberExpression(me(e.object),me(e.property)):R.identifier(e.name.name),"convertJSXToAST:jsx.ts");var X=d(e=>Array.isArray(e)?e[0]:e,"resolvePath:path.ts"),lr=d(e=>{let t=!1;return e.traverse({ReturnStatement(){t=!0}}),t},"hasReturnStatement:path.ts");var fe=d((e,t)=>{let r=new Map,n={},o=(c,p)=>{let f=`${c}@${p}`;return r.has(f)||r.set(f,ue(e,c,p)),r.get(f)},a=c=>{let p=`default@${c}`;return r.has(p)||r.set(p,ue(e,"default",c,{nameHint:"_"})),r.get(p)},i=0;return{addNamed:o,addDefault:a,addExport:(c,p,f)=>{n[`export_${c??i++}`]={kind:"export",loc:[(p==null?void 0:p.start.line)||0,(p==null?void 0:p.start.column)||0,(p==null?void 0:p.end.line)||0,(p==null?void 0:p.end.column)||0],jsx:!!f}},importMap:r,externalsMap:n,options:t}},"createModuleFactory:mod.ts"),b=d((e,t,r)=>{let n=e.node.callee;if(A.isMemberExpression(n)){if(!A.isIdentifier(n.property))return!1;n=n.property}if(!A.isIdentifier(n))return!1;let o=e.scope.getBinding(n.name);if(!o||!o.path.isImportSpecifier()||!A.isIdentifier(o.path.node.imported))return!1;let a=t.indexOf(o.path.node.imported.name);return a===-1||!o.path.parentPath.isImportDeclaration()||o.path.parentPath.node.source.value!==r?!1:t[a]},"isImportFrom:mod.ts"),$=d((e,t)=>{var n;if((n=t==null?void 0:t.node)!=null&&n.loc||Y(t.node))return;let r=null;t.traverse({MemberExpression(o){A.isIdentifier(o.node.property)&&(r=o.node.property.name)},Identifier(o){r=o.node.name,o.stop()}}),e.addExport(r,t.node.loc,J(X(t.get("declaration"))))},"createESMExport:mod.ts"),de=d((e,t)=>{var n;if((n=t==null?void 0:t.node)!=null&&n.loc||Y(t.node)||!A.isIdentifier(t.node.property)||!A.isIdentifier(t.node.object)||t.node.object.name!=="module"||t.node.property.name!=="exports")return;let r=t.find(o=>o.isAssignmentExpression());r&&e.addExport(null,r.node.loc,J(X(r.get("right"))))},"createCJSExport:mod.ts"),ee=new Map,ge=d((e,t)=>{let n=t.path.component.scope.getAllBindings();for(let o in n){let a=n[o];if(a&&o===t.name||a.scope.uid===t.path.real.scope.uid)continue;if(ee.has(`${o}::${a.scope.uid}`)){e.externalsMap[o]=ee.get(`${o}::${a.scope.uid}`);continue}let i=a.kind,l=a.path.node.loc;o==="arguments"||i==="param"||(e.externalsMap[o]={kind:i,loc:[(l==null?void 0:l.start.line)||0,(l==null?void 0:l.start.column)||0,(l==null?void 0:l.end.line)||0,(l==null?void 0:l.end.column)||0],jsx:J(a.path)},ee.set(`${o}::${a.scope.uid}`,e.externalsMap[o]))}return e.externalsMap},"getExternals:mod.ts");import*as W from"@babel/types";var K=e=>W.isJSXNamespacedName(e)?`${e.namespace.name}:${e.name.name}`:W.isJSXMemberExpression(e)?`${K(e.object)}.${K(e.property)}`:e.name;import*as E from"@babel/types";var V=new Map,C=(e,t)=>{let r=`${e}::${t}`;return ye(r)},ye=d((e,t=0)=>{if(V.has(e))return V.get(e);let r=3735928559^t,n=1103547991^t;for(let a=0,i;a<e.length;a++)i=e.charCodeAt(a),r=Math.imul(r^i,2654435761),n=Math.imul(n^i,1597334677);r=Math.imul(r^r>>>16,2246822507),r^=Math.imul(n^n>>>13,3266489909),n=Math.imul(n^n>>>16,2246822507),n^=Math.imul(r^r>>>13,3266489909);let o=4294967296*(2097151&n)+(r>>>0);if(V.has(e)){if(V.get(e)!==o)return ye(e,t+1)}else V.set(e,o);return o},"hash:hash.ts");import*as I from"@babel/types";var ft=I.arrayExpression([I.numericLiteral(0),I.numericLiteral(0),I.numericLiteral(0),I.numericLiteral(0)]),h=d(e=>{if(!e)return ft;let{start:t,end:r}=e;return I.arrayExpression([I.numericLiteral(t.line),I.numericLiteral(t.column),I.numericLiteral(r.line),I.numericLiteral(r.column)])},"getSourceLocation:loc.ts");import*as F from"@babel/types";var xe=d(e=>{let t=null;if(e.isArrowFunctionExpression()||e.isFunctionExpression()){F.isBlockStatement(e.node.body)||(e.node.body=F.blockStatement([F.returnStatement(e.node.body)]));let l=!1,c=e.find(p=>(p.isObjectProperty()&&(l=!0),p.isVariableDeclarator()));if(!c||l)return null;t=c}else e.isFunctionDeclaration()&&(t=e);if(!t)return null;let r=null,n=null;if(e.isClassDeclaration()){let l=t.get("body.body").find(p=>p.isClassMethod({kind:"constructor"}));if(!l)return null;e=l;let c=l.node.params;for(let p=0,f=c.length;p<f;p++){let m=c[p];if(F.isIdentifier(m,{name:"props"})){r=m,n=x=>{c[p]=x};break}}}else if(e.isFunctionDeclaration()||e.isFunctionExpression()||e.isArrowFunctionExpression()){let l=e.node.params;r=l[0]||null,n=c=>{l[0]=c}}let o=t.node.id;if(!(F.isIdentifier(o)&&k(o.name)&&J(e)))return null;let i={name:String(o.name),props:r,setProps:n,path:{real:e,component:t},type:{real:e.type,component:t.type}};return e._hir=i,i},"createHir:hir.ts"),te=new Map,H=d(e=>{if(te.has(e))return te.get(e);let t=null;return e.find(r=>(t=r._hir,!!t)),t&&te.set(e,t),t},"getHir:hir.ts");var q=d((e,t,r,n,o,a,i)=>{let l=H(r);if(!l)return;let c=e.addNamed(t,"@million/lint/runtime"),p=E.addComment(E.callExpression(c,[E.numericLiteral(C(n,l.name)),r.node,h(a??r.node.loc),E.numericLiteral(o),i?E.objectExpression([E.objectProperty(E.identifier("name"),E.stringLiteral(i.name)),E.objectProperty(E.identifier("loc"),h(i.loc))]):E.nullLiteral()]),"leading","million ignore"),[f]=r.replaceWith(p);f.skip(),r.skip()},"captureGeneric:generic.ts");import*as P from"@babel/types";var Se=d((e,t,r,n)=>{var p;let o=t.path.component.scope.generateUidIdentifier("props"),a=t.props,i=e.addNamed("captureProps","@million/lint/runtime"),l=P.addComment(P.callExpression(i,[P.numericLiteral(C(r,t.name)),o,h(a.loc),P.numericLiteral(n)]),"leading","million ignore");t.path.real.node.body.body.unshift(P.variableDeclaration("let",[P.variableDeclarator(a,o)]),P.expressionStatement(l)),(p=t.setProps)==null||p.call(t,o)},"captureProps:props.ts");import*as S from"@babel/types";var be=d((e,t)=>{let r=e.addNamed("registerFile","@million/lint/runtime");return S.callExpression(r,[S.stringLiteral(t),S.stringLiteral(process.cwd()),e.addDefault("react"),S.stringLiteral(e.options.framework||"")])},"registerFile:register.ts"),dt=S.memberExpression(S.identifier("JSON"),S.identifier("parse")),Ee=d((e,t,r,n)=>{let o=ge(e,t),a=JSON.stringify(o),i=e.addNamed("registerComponent","@million/lint/runtime");return S.callExpression(i,[S.stringLiteral(r),S.stringLiteral(t.name),S.numericLiteral(C(r,t.name)),S.identifier(t.name),S.callExpression(dt,[S.stringLiteral(a)]),h(t.path.real.isArrowFunctionExpression()?t.path.component.parentPath.node.loc:t.path.component.node.loc),S.numericLiteral(n)])},"registerComponent:register.ts"),_r=d((e,t,r,n)=>{let o=e.addNamed("registerStateManager","@million/lint/runtime");return S.callExpression(o,[S.stringLiteral(t),S.stringLiteral(r),S.arrayExpression(n.map(i=>S.objectExpression([S.objectProperty(S.identifier("type"),S.stringLiteral(i.type)),S.objectProperty(S.identifier("loc"),h(i.loc))])))])},"registerStateManager:register.ts");import*as w from"@babel/types";var re=d((e,t,r,n)=>{let o=H(t);if(!o)return;let a=w.cloneNode(t.node),i=t.find(f=>f.isJSXExpressionContainer()),l=e.addNamed("captureJSX","@million/lint/runtime"),c=w.addComment(w.callExpression(l,[w.numericLiteral(C(r,o.name)),a,h(t.node.loc),h((i==null?void 0:i.node.loc)??t.node.loc),w.numericLiteral(n)]),"leading","million ignore"),[p]=t.replaceWith(t.parentPath.isJSXElement()||t.parentPath.isJSXFragment()?w.jsxExpressionContainer(c):c);p.skip()},"captureJSX:jsx.ts");import*as L from"@babel/types";var he=d((e,t,r)=>{let n=e.addNamed("useMount","@million/lint/runtime"),o=L.addComment(L.callExpression(n,[L.stringLiteral(r),L.stringLiteral(t.name)]),"leading","million ignore");t.path.real.node.body.body.unshift(L.expressionStatement(o))},"captureMount:mount.ts");import*as j from"@babel/types";var Te=d((e,t,r,n,o,a)=>{let i=H(r);if(!i)return;let l=e.addNamed(t,"@million/lint/runtime"),c=[];if(r.isArrayExpression()){let m=r.node.elements;for(let x=0,M=m.length;x<M;x++){let T=m[x];c.push(T==null?void 0:T.loc)}}let p=j.addComment(j.callExpression(l,[j.numericLiteral(C(n,i.name)),r.node,h(a??r.node.loc),j.arrayExpression(c.map(m=>h(m))),j.numericLiteral(o)]),"leading","million ignore"),[f]=r.replaceWith(p);f.skip(),r.skip()},"captureDeps:generic.ts");import*as N from"@babel/types";var Pe=d((e,t,r,n)=>{let o=H(t);if(!o)return;let a=e.addNamed("captureHTTP","@million/lint/runtime"),i=[];N.traverseFast(t.node,p=>{N.isStringLiteral(p)&&p.value.includes("/")&&i.push(p)});let l=N.addComment(N.callExpression(a,[N.numericLiteral(C(r,o.name)),t.node,h(t.node.loc),N.arrayExpression(i),N.numericLiteral(n)]),"leading","million ignore"),[c]=t.replaceWith(l);c.skip(),t.skip()},"captureHTTP:http.ts");var O=d((e,t,r,n)=>{if(t.scope.parent.uid!==r.scope.uid)return;if(t.isClass()){let c=t.node.superClass;if(!v.isMemberExpression(c))return;let p=c.object,f=c.property;if(!v.isIdentifier(p)||!v.isIdentifier(f)||p.name!=="React"||f.name!=="Component")return}let o=xe(t);if(!o)return;he(e,o,n);let a=0;o.props&&(v.isObjectPattern(o.props)||v.isIdentifier(o.props))&&Se(e,o,n,a++);let i=[];t.traverse({CallExpression(c){if(Z(c))return;let p=c.node.callee;if(v.isIdentifier(p)){if(["fetch","useQuery","useSWR"].includes(p.name)){Pe(e,c,n,a++);return}if(p.name.startsWith("use")){if(b(c,["useState","useReducer"],"react")||b(c,["useAtom"],"jotai")){q(e,"captureReducer",c,n,a++);return}if(b(c,["useContext"],"react")||b(c,["useSelector"],"react-redux")||b(c,["useSnapshot"],"valtio")||b(c,["useRecoilState"],"recoil")||b(c,["useAtomValue"],"jotai")){q(e,"captureFunctionCall",c,n,a++);return}if(b(c,["useEffect","useLayoutEffect","useMemo","useCallback","useInsertionEffect"],"react")&&c.node.arguments.length>1){let f=X(c.get("arguments.1"));if(!f.isExpression())return;Te(e,"captureDeps",f,n,a++,c.node.loc);return}}}v.isMemberExpression(p)&&v.isIdentifier(p.property)&&p.property.name==="setState"&&v.isIdentifier(p.object)&&p.object.name==="this"&&q(e,"captureClassSetState",c,n,a)},JSXElement(c){let p=c.node,f=K(p.openingElement.name);if(k(f)){if(f.includes("Provider")){i.unshift(()=>{re(e,c,n,a)});return}re(e,c,n,a)}}});for(let c=0,p=i.length;c<p;c++)i[c]();return Ee(e,o,n,a+1)},"transformComponent:index.ts");import*as u from"@babel/types";var gt=u.memberExpression(u.memberExpression(u.identifier("import"),u.identifier("meta")),u.identifier("hot")),yt=u.memberExpression(u.memberExpression(u.identifier("import"),u.identifier("meta")),u.identifier("webpackHot")),Ne=u.memberExpression(u.identifier("module"),u.identifier("hot")),xt=u.binaryExpression("===",u.unaryExpression("typeof",u.identifier("module")),u.stringLiteral("undefined")),Ce=d((e,t,r,n)=>{let o=e.options.framework==="webpack"?yt:gt,a=n.length,i=new Array(a);for(let T=0;T<a;T++)i[T]=u.expressionStatement(n[T]);let l=t.scope.generateUidIdentifier("c"),c=e.addNamed("resync","@million/lint/runtime"),p=e.addNamed("reportOutliers","@million/lint/runtime"),f=u.variableDeclaration("let",[u.variableDeclarator(l,u.arrowFunctionExpression([],u.blockStatement(i)))]),m=u.arrowFunctionExpression([],u.blockStatement([u.expressionStatement(u.callExpression(l,[])),u.expressionStatement(u.callExpression(c,[])),u.expressionStatement(u.callExpression(p,[]))])),x=u.ifStatement(Ne,u.blockStatement([u.expressionStatement(u.callExpression(u.memberExpression(Ne,u.identifier("accept")),[u.stringLiteral(r),m]))])),M=e.options.legacyHmr?x:u.ifStatement(xt,u.blockStatement([u.ifStatement(o,u.blockStatement([u.expressionStatement(u.callExpression(u.memberExpression(o,u.identifier("accept")),[u.stringLiteral(r),m]))]))]),x);return St([f,M,u.expressionStatement(u.callExpression(l,[]))])},"wrapHMR:hmr.ts"),St=d(e=>u.expressionStatement(u.callExpression(u.arrowFunctionExpression([],u.blockStatement(e)),[])),"wrapIIFE:hmr.ts");import*as Ie from"@babel/types";var ve=d(e=>{let t=e.node.body,r=[];for(let n=0,o=t.length;n<o;n++){let a=t[n];if(!Ie.isImportDeclaration(a))continue;let i=a.specifiers,l=a.source.value;if(!i.length)continue;let c=a.loc,p={specifiers:[],source:l,start:a.start,end:a.end,loc:[c.start.line,c.start.column,c.end.line,c.end.column]};r.push(p);for(let f=0,m=i.length;f<m;f++){let x=i[f];p.specifiers.push(x.local.name)}}return r},"getImports:debug");import"isomorphic-fetch";var we=process.cwd(),oe=d(async e=>{try{let t=await ke();for(let r=0,n=t.length;r<n;r++){let{port:o,cwd:a}=t[r];!e.includes(a)&&!we.includes(a)||fetch(`http://localhost:${o}/reset`).catch(()=>null)}}catch{}},"reset:http.ts"),Me=d(async(e,t)=>{let r=[];for(let i in t){let l=t[i];for(let c=0,p=l.length;c<p;c++)r.push(l[c])}r.sort((i,l)=>l.size-i.size);let n=[];for(let i=0,l=r.length;i<l;i++){if(i<l*.25){n.push(r[i]);continue}break}let o={};for(let i=0,l=n.length;i<l;i++){let c=n[i];o[c.filename]||(o[c.filename]=[]),o[c.filename].push(c)}let a={};for(let i in t){let l=t[i];for(let c=0,p=l.length;c<p;c++)a[i]=l}try{await Re(e,{bundle:{all:a,outliers:o}})}catch{}},"reportBundle:http.ts"),De=d(async(e,t)=>{try{await Re(e,{stateManagers:t})}catch{}},"reportStateManagers:http.ts"),Re=d(async(e,t)=>{try{let r=await ke();for(let n=0,o=r.length;n<o;n++){let{port:a,cwd:i}=r[n];!e.includes(i)&&!we.includes(i)||fetch(`http://localhost:${a}/ingest?t=${Object.keys(t).join(",")}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).catch(()=>null)}}catch{}},"report:http.ts"),ke=d(async()=>(await fetch(`http://localhost:${52921}`)).json(),"getSync:http.ts");import{promises as Nt}from"fs";import{builtinModules as Ct}from"module";import ie from"path";import{promisify as It}from"util";import vt from"zlib";import*as He from"esbuild";import{promises as Et}from"fs";import{createRequire as ht}from"module";import Ae from"path";import Fe from"escalade";var z="package.json",ne=async e=>await Fe(e,(r,n)=>n.includes(z)?z:void 0)??void 0,Tt=async e=>{let t=await Et.readFile(e,"utf-8");return JSON.parse(t)},Pt=(e,t,r)=>Fe(e,async(n,o)=>{if(!o.includes(z))return;let a=Ae.join(n,z),i=await Tt(a);return r==null||r(a,i),i.name===t?z:void 0}),Le=async(e,t)=>{let n=ht(Ae.resolve(t,"<import>.js")).resolve(e),o=e.startsWith("@"),[a,i]=o?e.split("/"):[e.split("/")[0],""],l=a+(o?"/":"")+i,c,p;try{p=`${l}/package.json`,c=B(p)}catch{}let f,m;if(n!==l){let x=[];await Pt(n,l,(T,U)=>{x.push([T,U])})&&x.length>0&&([p,c]=x[x.length-1],x.length>1&&([m,f]=x[0]))}return{rootPackageFile:p,rootPackage:c,modulePackageFile:m,modulePackage:f}};var wt=It(vt.gzip),Mt=e=>wt(e).then(t=>t.length),je=async e=>!!await Nt.stat(e).catch(()=>null);var Dt=e=>[e&&`export {${Object.values({...e}).join(", ")}}`].filter(Boolean).join(`
`),se=RegExp(`^node:|^(${Ct.join("|")})(/|$)`),Rt={name:"external",setup(e){e.onResolve({filter:se,namespace:"file"},t=>({path:t.path,external:!0}))}},kt=/^[a-z@]/,At={name:"external",setup(e){let t=new Map,r=new Map;e.onResolve({filter:kt,namespace:"file"},async n=>{if(se.test(n.path))return null;let o,a=n.resolveDir;if(t.has(a))o=await t.get(a);else{let i=ne(a).then(l=>l?B(l):null);t.set(a,i),o=await i}if(o!=null&&o.peerDependencies&&n.path in o.peerDependencies){let i=r.get(o.name);return i||(i=new Set,r.set(o.name,i)),i.add(n.path),{path:n.path,external:!0}}return null})}},Ue=new Map,Ft=(e,t)=>`${e.name}:${e.version}:${t}`,Lt=async(e,t,{filename:r,baseDir:n,projectPackageFile:o,cache:a=!1})=>{let i=t.source,[l]=i.split("/");if(se.test(l))throw new Error("Skip builtin modules");let c=`${e}
${Dt(t.specifiers)}`,{rootPackage:p}=await Le(i,n).catch(()=>({})),f=a&&p!==void 0&&Ft(p,c);if(a&&f){let D=Ue.get(f);if(D)return D}let m=p?Object.keys({...p.peerDependencies}):[],x=o?ie.dirname(o):n,M=await He.build({stdin:{loader:"ts",contents:c,resolveDir:ie.dirname(r),sourcefile:"<import>"},outfile:"<bundle>.js",absWorkingDir:x,plugins:[Rt,At],resolveExtensions:[".jsx",".js",".tsx",".ts",".css",".json"],loader:{".node":"binary",".jpeg":"empty",".jpg":"empty",".png":"empty",".webp":"empty",".gif":"empty",".svg":"empty"},external:m,target:"esnext",format:"esm",platform:"browser",metafile:!1,minify:!0,bundle:!0,write:!1,logLimit:0,logLevel:"silent"}),T=await Promise.all(M.outputFiles.map(async D=>{let _=D.contents.length;return[_,_===0?0:await Mt(Buffer.from(D.contents))]})),U=0;for(let D=0,_=T.length;D<_;D++)U+=T[D][1];return a&&f&&Ue.set(f,U),U};async function*Je(e,t,r){let n=process.cwd(),o=t&&await je(t)?ie.dirname(t):n&&await je(n)?n:null;if(!o)return null;let a=await ne(o),i={filename:t,baseDir:o,projectPackageFile:a,cache:!0};for(let l=0,c=r.length;l<c;l++){let p=r[l],f=e.substring(p.start,p.end);try{let m=await Lt(f,p,i);m&&(yield m)}catch{}}}var jt=async(e,t,r)=>{let n=[],o=0;for await(let a of Je(e,t,r)){let i=r[o];n.push({size:a,filename:t,loc:i.loc}),o++}return n},Oe={},Xe=async(e,t,r)=>{try{let n=await jt(e,t,r);return Oe[t]=n,await Me(t,Oe),n}catch{}return[]};import*as $e from"@babel/types";var Ve=(e,t)=>{let r=e.options.filename,n=t.node.callee;if(!$e.isIdentifier(n))return null;let o=b(t,["atom"],"jotai");if(!o)return null;let a=t.find(l=>l.isVariableDeclarator());if(!a)return null;let i=a.node.loc;return{filename:r,type:o,loc:[i.start.line,i.start.column,i.end.line,i.end.column]}};import*as ze from"@babel/types";var _e=(e,t)=>{let r=e.options.filename,n=t.node.callee;if(!ze.isIdentifier(n))return null;let o=b(t,["atom","selector"],"recoil");if(!o)return null;let a=t.find(l=>l.isVariableDeclarator());if(!a)return null;let i=a.node.loc;return{filename:r,type:o,loc:[i.start.line,i.start.column,i.end.line,i.end.column]}};import*as ae from"@babel/types";var Be=(e,t)=>{let r=e.options.filename;if(t.isCallExpression()){let n=t.node.callee;if(!ae.isIdentifier(n))return null;let o=b(t,["configureStore","createSlice","createReducer"],"@reduxjs/toolkit");if(!o)return null;let a=t.find(l=>l.isVariableDeclarator());if(!a)return null;let i=a.node.loc;return{filename:r,type:o,loc:[i.start.line,i.start.column,i.end.line,i.end.column]}}if(t.isFunctionDeclaration()||t.isVariableDeclarator()){let n=t.node.id;if(!ae.isIdentifier(n))return null;if(n.name.toLowerCase().includes("reducer")){let o=t.node.loc;return{filename:r,type:"reducer",loc:[o.start.line,o.start.column,o.end.line,o.end.column]}}}return null};import*as Ke from"@babel/types";var We=(e,t)=>{let r=e.options.filename,n=t.node.callee;if(!Ke.isIdentifier(n))return null;let o=b(t,["proxy"],"valtio");if(!o)return null;let a=t.find(l=>l.isVariableDeclarator());if(!a)return null;let i=a.node.loc;return{filename:r,type:o,loc:[i.start.line,i.start.column,i.end.line,i.end.column]}};import*as qe from"@babel/types";var Ge=(e,t)=>{let r=e.options.filename,n=t.node.callee;if(!qe.isIdentifier(n))return null;let o=b(t,["create"],"zustand");if(!o)return null;let a=t.find(l=>l.isVariableDeclarator());if(!a)return null;let i=a.node.loc;return{filename:r,type:o,loc:[i.start.line,i.start.column,i.end.line,i.end.column]}};import*as Qe from"@babel/types";var Ze=(e,t)=>{let r=e.options.filename,n=t.node.callee;if(!Qe.isIdentifier(n))return null;let o=b(t,["makeAutoObservable"],"mobx-react-lite");if(!o)return null;let a=t.find(l=>l.isClassDeclaration());if(!a)return null;let i=a.node.loc;return{filename:r,type:o,loc:[i.start.line,i.start.column,i.end.line,i.end.column]}};var G=(e,t,r)=>{let{source:n}=e.options;if(n){if(n.includes("jotai")&&t.isCallExpression()){let o=Ve(e,t);o&&(r.jotai??(r.jotai=[]),r.jotai.push(o))}if(n.includes("recoil")&&t.isCallExpression()){let o=_e(e,t);o&&(r.recoil??(r.recoil=[]),r.recoil.push(o))}if(n.includes("valtio")&&t.isCallExpression()){r.valtio??(r.valtio=[]);let o=We(e,t);o&&(r.valtio??(r.valtio=[]),r.valtio.push(o))}if(n.includes("zustand")&&t.isCallExpression()){let o=Ge(e,t);o&&(r.zustand??(r.zustand=[]),r.zustand.push(o))}if(n.includes("redux")&&(t.isCallExpression()||t.isVariableDeclarator()||t.isFunctionDeclaration())){r.redux??(r.redux=[]);let o=Be(e,t);o&&(r.redux??(r.redux=[]),r.redux.push(o))}if(n.includes("mobx")&&t.isCallExpression()){let o=Ze(e,t);o&&(r.mobx??(r.mobx=[]),r.mobx.push(o))}}};var Ye=(e,t={})=>{let r=t.filename||"",n=[],o=()=>{var i;a||(a=!0,(i=n.shift())==null||i())},a=!1;return{name:"anya",visitor:{Program(i){let l=ve(i),c=[],p={};if(t.rsc&&!pe(i))return;let f=fe(i,t);if(c.push(be(f,r)),i.traverse({CallExpression(m){t.extra&&G(f,m,p)},ArrowFunctionExpression(m){if(!t.isJSX)return;let x=O(f,m,i,r);x&&c.push(x)},FunctionDeclaration(m){if(t.extra&&G(f,m,p),!t.isJSX)return;if(m.node.id&&!k(m.node.id.name)){m.skip();return}let x=O(f,m,i,r);x&&c.push(x)},FunctionExpression(m){if(!t.isJSX)return;if(m.node.id&&!k(m.node.id.name)){m.skip();return}let x=O(f,m,i,r);x&&c.push(x)},VariableDeclarator(m){t.extra&&G(f,m,p)},ClassDeclaration(m){if(t.isJSX){if(m.node.id&&!k(m.node.id.name)){m.skip();return}O(f,m,i,r)}},ClassExpression(m){if(t.isJSX){if(m.node.id&&!k(m.node.id.name)){m.skip();return}O(f,m,i,r)}},MemberExpression(m){t.isJSX&&de(f,m)},ExportAllDeclaration(m){t.isJSX&&$(f,m)},ExportDefaultDeclaration(m){t.isJSX&&$(f,m)},ExportNamedDeclaration(m){t.isJSX&&$(f,m)},ExportNamespaceSpecifier(m){t.isJSX&&$(f,m)}}),!!c.length){if(t.isJSX){let m=Ce(f,i,r,c);i.node.body.push(m)}De(r,p),n.push(async()=>{await Xe(t.source,r,l),a=!1,o()}),o()}}}}};var et=Ye;var tt=d((e,t,r)=>{let n=new Set(r),o=-1,a=-1,i;for(let l=0,c=e.length;l<c;l+=1){let p=e[l];n.has(p.name)&&o===-1&&(o=l),p.name===t&&(a=l,i=p)}o!==-1&&a!==-1&&o<a&&(e.splice(a,1),e.splice(o,0,i))},"repushPlugin:plugin.ts"),le=d(e=>e.replace(process.cwd(),""),"getRelativePath:plugin.ts");import{bold as Ut,gray as Ht,green as ot,magenta as Jt}from"kleur/colors";var rt=!1,nt=()=>{if(rt)return;let e=performance.now();rt=!0,console.log(`
 ${Ut(Jt("\u26A1 Million Lint v0.0.66"))}`),console.log(` ${ot("\u2713")} Ready in ${(performance.now()-e).toFixed(2)}ms`)},it=e=>(console.log(` ${Ht("\u25CB")} Compiling ${le(e)} ...`),performance.now()),st=(e,t,r)=>{if(t===null)return 0;let n=performance.now()-t;return console.log(` ${ot("\u2713")} Compiled ${le(e)} in ${n.toFixed(2)}ms (total: ${r.toFixed(2)}ms)`),n};var Vt="**/*.{jsx,tsx,ts,js,mjs,cjs}",zt="**/node_modules/**/*",at=!1,ce=()=>at,_t=process.env.NODE_ENV==="production",lt=Ot((e={},t)=>{var a,i;if(_t)return{name:"anya"};nt();let r=Xt(((a=e.filter)==null?void 0:a.include)||Vt,((i=e.filter)==null?void 0:i.exclude)||[zt,"**/_app.{jsx,tsx,js,ts}","**/_document.{jsx,tsx,js,ts}"]),n=null,o=0;return at=e.dev||!1,e.framework??(e.framework=t.framework),{enforce:"pre",name:"anya",watchChange(l){o=0,oe(l)},transformInclude(l){let c=r(l);return c&&e.dev&&(n=it(l)),c},async transform(l,c){var p;try{let f=!0;if((c.endsWith(".ts")||c.endsWith(".mjs")||c.endsWith(".cjs"))&&(f=!1),c.endsWith(".js")&&!/<(?<temp1>"[^"]*"|'[^']*'|[^'">])*>/.test(l)&&(f=!1),e.extra===!1&&!f)return null;let m=["jsx",["importAttributes",{deprecatedAssertSyntax:!1}],"throwExpressions","decorators","destructuringPrivate","explicitResourceManagement"];if(/\.[mc]?tsx?$/i.test(c)&&m.push("typescript"),(p=e.plugins)!=null&&p.length)for(let M=0,T=e.plugins.length;M<T;M++){let U=e.plugins[M];typeof U=="string"&&m.push(U)}let x=await $t(l,{plugins:[[et,{...e,source:l,isJSX:f,filename:c,extra:!0}]],parserOpts:{plugins:m},filename:c,ast:!1,sourceFileName:c,sourceMaps:!0,configFile:!1,babelrc:!1});if(e.dev&&(o+=st(c,n,o)),x)return{code:x.code||"",map:x.map}}catch{}return null},vite:{handleHotUpdate(l){o=0,oe(l.file)},configResolved(l){tt(l.plugins,"anya",["astro:jsx","vite:react-babel","vite:react-jsx","vite:preact-jsx","vite:react-swc"])}}}});var Bt=lt.rollup,yi=Bt;export{yi as default,Bt as rollup};
